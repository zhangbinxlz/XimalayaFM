# XimalayaFM

python爬取喜马拉雅音频

完成VIP音频下载功能  

# 使用方法：  

* Vip资源解析采用了browsermobproxy，所以需要安装jdk才可使用
* 首先你已经开通了喜马会员   
* 该音频属于会员或者付费可听  
* 运行程序，选择`VIP`选项，然后输入音频集的albumID，以及你的token，点击运行即可  

token在下图这里复制  
![](http://image.joelyings.com/2020-02-02_1.png)

就是`1&_token=xxx;`，xxx这一部分


# What I Do
* 由于原作者的程序针对收费资源已经失效，所以进行了修改，采用了browsermobproxy抓包解析出m4a地址
* 保存文件时命名采用的时音频的标题，难免会存在非法符号无法作为文件名，所以利用re去除了非法字符
* 由于网络环境等问题会出现获取下载地址失败的情况和下载时失败的情况，添加了失败重试的功能
* 先get音频资源到缓存再写入本地，防止新建文件后下载失败导致的本地存在文件但无法打开的情况发生
* 爬取文件前会先看保存目录下是否已经存在当前文件，若存在说明已经下载过，直接跳过
